(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[904],{70009:(e,t,n)=>{Promise.resolve().then(n.bind(n,7217))},7217:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Random:()=>T,default:()=>D});var a=n(95155),r=n(46742),s=n(22810),l=n(2796),i=n(79005),o=n(12115);let c=[{id:"com",name:"Cơm"},{id:"cut",name:"Cứt"}],d="GET_RANDOM_LIST";var u=n(41657),h=n(82133),m=n(76237),x=n(17342),j=n(7787),A=n(27656),f=n(13697),p=n(547),y=n(43302),g=n(35906),w=n(25848),b=n(89670),v=n(99373),k=n(57810),S=n(79254),C=n.n(S),N=n(49113),_=n.n(N);let{Dragger:L}=b.A,{Paragraph:R}=r.A,I=function(e){let{setListTemp:t}=e,n=async e=>{try{let n=new(C()).Workbook,a=await e.arrayBuffer();await n.xlsx.load(a);let r=n.worksheets[0],s=[];r.eachRow((e,t)=>{t>1&&s.push(_().get(e.values,1))}),t(s.concat("").map(e=>({id:(0,f.A)(),name:e}))),v.Ay.success("Đọc file th\xe0nh c\xf4ng!")}catch(e){console.error("Error reading Excel file",e),v.Ay.error("Kh\xf4ng đọc được file Excel")}};return(0,a.jsxs)("div",{className:"pb-4",children:[(0,a.jsxs)(L,{name:"file",multiple:!1,beforeUpload:e=>(n(e),!1),onDrop(e){console.log("Dropped files",e.dataTransfer.files)},accept:".xlsx",children:[(0,a.jsx)("p",{className:"ant-upload-drag-icon",children:(0,a.jsx)(k.A,{})}),(0,a.jsx)(R,{children:"Nhập từ file excel hoặc nhập thủ c\xf4ng từng m\xf3n"})]}),(0,a.jsx)("a",{href:"/mon-an-ngau-nhien.xlsx",target:"_blank",children:"Tải file mẫu"})]})},{Title:q}=r.A;function E(e){let{setFoodList:t}=e,[n,r]=(0,o.useState)(!1),[c,b]=(0,o.useState)("Danh s\xe1ch chưa đặt t\xean"),[v,k]=(0,o.useState)([{id:(0,f.A)(),name:""}]),{data:S}=(0,p.I)({queryKey:[d],queryFn:()=>(0,y.oJ)()}),{mutate:C}=function(){let e=(0,g.jE)();return(0,w.n)({mutationFn:y.ln,onSuccess(){e.invalidateQueries({queryKey:[d]})}})}(),{mutate:N}=function(){let e=(0,g.jE)();return(0,w.n)({mutationFn:e=>(0,y.Hd)(e),onSuccess(){e.invalidateQueries({queryKey:[d]})}})}(),_=(0,o.useCallback)((e,t)=>{let n=v.map((n,a)=>t===a?{...n,name:e}:n);t===v.length-1&&n.push({id:(0,f.A)(),name:""}),k(n)},[v]),L=(0,o.useCallback)(e=>{k(v.filter((t,n)=>n!==e))},[v]),R=[{title:"T\xean m\xf3n",dataIndex:"name",key:"name",render:(e,t,n)=>(0,a.jsx)(u.A,{value:e,placeholder:"Tab để sang d\xf2ng kế tiếp",onChange:e=>_(e.target.value,n)})},{title:"Xo\xe1",dataIndex:"delete",key:"delete",width:20,render:(e,t,n)=>n!==v.length-1?(0,a.jsx)(A.A,{onClick:()=>L(n)}):null}];return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.Ay,{onClick:()=>r(!0),children:"Chọn m\xf3n"}),(0,a.jsx)(h.A,{title:"Chọn m\xf3n",onClose:()=>r(!1),open:n,width:"80%",footer:(0,a.jsx)(s.A,{justify:"end",children:(0,a.jsx)(l.A,{children:(0,a.jsx)(i.Ay,{type:"primary",onClick:function(){let e=v.filter(e=>e.name);C({name:c,list:e}),t(e),b("Danh s\xe1ch chưa đặt t\xean"),k([{id:(0,f.A)(),name:""}]),r(!1)},children:"Xong"})})}),children:(0,a.jsxs)(s.A,{gutter:[10,10],children:[(0,a.jsxs)(l.A,{span:24,md:12,children:[(0,a.jsx)(q,{level:3,children:"Nhập danh s\xe1ch m\xf3n"}),(0,a.jsx)(m.A,{children:(0,a.jsx)(m.A.Item,{label:"T\xean danh s\xe1ch",children:(0,a.jsx)(u.A,{allowClear:!0,value:c,onChange:e=>b(e.target.value)})})}),(0,a.jsx)(I,{setListTemp:k}),(0,a.jsx)(x.A,{columns:R,dataSource:v,pagination:!1})]}),(0,a.jsxs)(l.A,{span:24,md:12,children:[(0,a.jsx)(q,{level:3,children:"Danh s\xe1ch m\xf3n đ\xe3 lưu"}),(0,a.jsx)(j.A,{itemLayout:"horizontal",dataSource:null!=S?S:[],renderItem:e=>(0,a.jsx)(j.A.Item,{actions:[(0,a.jsx)("a",{onClick:()=>{N(e.id)},children:"Xo\xe1"},"delete")],children:(0,a.jsx)(j.A.Item.Meta,{title:(0,a.jsx)("a",{onClick:()=>{t(e.items),r(!1)},children:e.name}),description:e.items.map(e=>e.name).join(", ")})})})]})]})})]})}let{Title:P,Paragraph:O}=r.A;function T(){let[e,t]=(0,o.useState)(c),[n,r]=(0,o.useState)(),d=(0,o.useCallback)(()=>e[Math.floor(Math.random()*e.length)],[e]),u=(0,o.useCallback)(()=>{let e=d();r(e);let t=0,n=setInterval(()=>{e=d(),t++,r(e),69===t&&clearInterval(n)},10)},[d]);return(0,o.useEffect)(()=>{u()},[u]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(P,{children:"M\xf3n ngẫu nhi\xean"}),(0,a.jsxs)(s.A,{children:[(0,a.jsx)(l.A,{flex:"auto",children:(0,a.jsx)(O,{className:"text-center px-14",children:(0,a.jsx)(P,{className:"text-center",children:null==n?void 0:n.name})})}),(0,a.jsx)(l.A,{flex:"none",children:(0,a.jsx)(E,{setFoodList:t})})]}),(0,a.jsx)(O,{className:"text-center",children:(0,a.jsx)(i.Ay,{onClick:u,variant:"outlined",color:"magenta",children:"Chọn lại"})})]})}let D=T},43302:(e,t,n)=>{"use strict";n.d(t,{Hd:()=>j,Kb:()=>h,Sj:()=>d,ln:()=>x,oJ:()=>m});var a=n(14449),r=n(21455),s=n.n(r),l=n(13697),i=n(49113),o=n.n(i),c=n(56818);let d=a.Oh.addCollection(c.q.RandomList);class u extends a.Ay{getRandomList(){return super.getAll(this.store)}async syncRandomList(){let e=d.find({});for(let t of(await super.deleteAll(this.store),e)){let e=o().omit(t,["$loki","meta"]);await super.save(this.store,e)}return e}constructor(...e){super(...e),this.store=c.q.RandomList}}let h=new u;function m(){return d.find({}).sort((e,t)=>s()(t.created_at).isAfter(s()(e.created_at))?1:-1)}async function x(e){let{name:t,list:n}=e,a=await Promise.resolve(d.insert({id:(0,l.A)(),name:t,items:n,created_at:s()().toDate()}));return await h.syncRandomList(),a}async function j(e){let t=await Promise.resolve(d.findAndRemove({id:e}));return await h.syncRandomList(),t}},56818:(e,t,n)=>{"use strict";n.d(t,{q:()=>a});var a=function(e){return e.RandomList="random_list",e.ShareBill="share_bill",e}({})},14449:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>o,Oh:()=>l});var a=n(51288),r=n.n(a),s=n(56818);let l=new(r())("anuong.db");class i{async init(){return this.database?this.database:new Promise((e,t)=>{let n=window.indexedDB.open("anuong",1);n.onupgradeneeded=()=>{let e=n.result;e.objectStoreNames.contains(s.q.RandomList)||e.createObjectStore(s.q.RandomList,{keyPath:"id",autoIncrement:!0}),e.objectStoreNames.contains(s.q.ShareBill)||e.createObjectStore(s.q.ShareBill,{keyPath:"id",autoIncrement:!0})},n.onsuccess=()=>{this.database=n.result,e(this.database)},n.onerror=()=>{t(n.error)}})}async save(e,t){let n=await this.init();return new Promise((a,r)=>{let s=n.transaction(e,"readwrite").objectStore(e),l=JSON.parse(JSON.stringify(t)),i=s.add(l);i.onsuccess=()=>a(),i.onerror=()=>r(i.error)})}async getAll(e){let t=await this.init();return new Promise((n,a)=>{let r=t.transaction(e,"readonly").objectStore(e).getAll();r.onsuccess=()=>n(r.result),r.onerror=()=>a(r.error)})}async deleteAll(e){let t=await this.init();return new Promise((n,a)=>{let r=t.transaction(e,"readwrite").objectStore(e).clear();r.onsuccess=()=>n(e),r.onerror=()=>a(r.error)})}constructor(){this.database=null}}let o=i}},e=>{var t=t=>e(e.s=t);e.O(0,[935,600,343,754,999,779,42,917,441,517,358],()=>t(70009)),_N_E=e.O()}]);